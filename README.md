# Итоговая работа по курсу «Базы данных»

## 1. Общая информация о проекте

В рамках итогового задания была спроектирована и реализована база данных для онлайн-магазина.  
Проект охватывает полный цикл работы с данными: от анализа предметной области и проектирования структуры до написания аналитических запросов и оптимизации производительности.

Основной целью работы является демонстрация навыков проектирования реляционных баз данных и применения возможностей PostgreSQL для анализа и оптимизации данных.

---

## 2. Модель предметной области и ER-диаграмма
[ER-диаграмма](erdiagram/erdiagram.PNG)

Для выбранной предметной области была разработана ER-диаграмма, отражающая ключевые бизнес-процессы интернет-магазина.

### Основные сущности модели:

- Пользователи системы
- Адреса доставки
- Категории товаров
- Товары
- Заказы
- Позиции заказов
- Платежи

ER-диаграмма описывает связи между сущностями, первичные и внешние ключи, а также основные атрибуты каждой таблицы.  
Диаграмма используется как основа для дальнейшей нормализации и физической реализации базы данных.

---

## 3. Нормализация данных

Проектируемая модель данных была приведена к третьей нормальной форме (3НФ) с целью устранения избыточности и обеспечения целостности информации.
[Процесс нормализации](Нормализация.md)
### Этапы нормализации:

- **Первая нормальная форма (1НФ)**  
  Устранены повторяющиеся группы данных, все атрибуты приведены к атомарному виду.

- **Вторая нормальная форма (2НФ)**  
  Устранены частичные зависимости неключевых атрибутов от составных ключей путём разделения данных на логические сущности.

- **Третья нормальная форма (3НФ)**  
  Исключены транзитивные зависимости, каждая таблица содержит только атрибуты, напрямую зависящие от первичного ключа.

В результате получена логически корректная и расширяемая структура базы данных.

---

## 4. Реализация базы данных (DDL)
[DDL-скрипт](join_request.sql)
На основе нормализованной модели был разработан DDL-скрипт для PostgreSQL, включающий:

- создание таблиц;
- определение первичных и внешних ключей;
- задание ограничений целостности данных (`NOT NULL`, `UNIQUE`, `CHECK`);
- создание индексов для повышения производительности запросов.

DDL-скрипт обеспечивает корректную физическую реализацию базы данных и готовность к эксплуатации.

---

## 5. Аналитические SQL-запросы

В рамках работы были реализованы аналитические запросы различной сложности:

- **Запрос с использованием CTE (WITH)**  
  Анализ продаж и определение наиболее прибыльных товаров на основе агрегированных данных.
[Запрос CTE](cte_request.sql)
- **Запрос с JOIN**  
  Получение информации о пользователях, их заказах и текущем статусе оплаты с использованием `INNER JOIN` и `LEFT JOIN`.
[Запрос JOIN](join_request.sql)
- **Запрос с оконными функциями**  
  Анализ активности пользователей с применением оконных функций для нумерации и подсчёта заказов без агрегации строк.
[Запрос с применением оконных функций](window_func.sql)
Данные запросы демонстрируют практическое применение SQL для бизнес-аналитики.

---

## 6. Оптимизация производительности
[Анализ производительности](analysis/optimization.sql) 
Для одного из аналитических запросов был выполнен анализ производительности с использованием команды `EXPLAIN ANALYZE`.

### В ходе оптимизации были выполнены следующие действия:

- анализ плана выполнения запроса; [Анализ плана](analysis/optimization.md)
- выявление узких мест (последовательные сканирования, дорогостоящие операции);
- создание индексов по часто используемым полям;
- рекомендации по дальнейшему улучшению структуры данных.

Результатом оптимизации стало снижение стоимости выполнения запроса и улучшение его масштабируемости при росте объёма данных.

---

## 7. Итоговые выводы

В ходе выполнения итоговой работы:

- спроектирована и реализована реляционная база данных для интернет-магазина;
- применены принципы нормализации для обеспечения целостности и непротиворечивости данных;
- разработаны аналитические запросы с использованием CTE, JOIN и оконных функций;
- выполнен анализ и оптимизация производительности SQL-запросов;
- построена аналитическая модель для OLAP-задач.

Выполненная работа демонстрирует комплексное понимание проектирования, реализации и оптимизации баз данных в PostgreSQL.
